<html>

<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/css/reveal.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/css/theme/white.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/atom-one-light.min.css">
  <meta charset="utf-8">
  <style>
    .reveal section img {
      border: none;
      box-shadow: none;
    }

    strong {color: GoldenRod ;}
    mark {background-color: GoldenRod ;}
    del{color: lightgray}

    i{color: darkgray;}

    .reveal ul { list-style-type: none; margin-left: 0;}
    .reveal ul li.bad:before {
      content: '- ';
      color: red;
      font-weight: bold;
    }
    .reveal ul li.good:before {
      content: '+ ';
      color: green;
      font-weight: bold;
    }
  </style>
</head>

<body>
  <div class="reveal">
    <div class="slides">
      <section>
        <section>
          <h1>Intégration Stripe</h1>
        </section>
        <section>
          <h2>Sommaire</h2>
          <ul>
            <li>Présentation de iSignif</li>
            <li>Intégration Stripe</li>
          </ul>
        </section>
      </section>


      <!-- Présentation de iSignif -->
      <section>

        <section>
          <img src="src/img/logo.svg" height="200">
          <p>SAS - LegalTech - 2017 - 4 associés</p>
        </section>

        <section>
          <h3>SAS</h3>
          <p><strong>S</strong>ociété par <strong>A</strong>ctions <strong>S</strong>implifiée</p>
          <ul>
            <li class="good">statut de <del>salarié</del> associé </li>
            <li class="bad"><del>salaire</del> dividende</li>
            <li class="good">souplesse sur les règles</li>
            <li class="bad">pacte d'actionnaire</li>
          </ul>
        </section>


        <section>
          <h3>Mon rôle</h3>

          <ul>
            <li><strong>associé</strong> décisions stratégiques</li>
            <li><strong>directeur technique</strong> choix techniques & dév.</li>
            <li><strong>dpo</strong> mise en conformité RGPD</li>
          </ul>
        </section>

        <section>
          <h3>Principe</h3>
          <p>Simplifier le processus de <strong>signification</strong></p>
          <img src="src/img/signification_after_before.png" alt="">
        </section>


        <section>
          <img src="src/img/workflow_money.png" alt="">
          <p> <strong class="good">8€ / mois</strong> pour les avocats</p>
          <p> <strong class="good">2€ / acte</strong> pour les huissiers</p>
        </section>

      </section>

      <!-- Présentation du projet -->

      <section>

        <img src="src/img/stripe.svg" alt="">
        <section>
          <ul>
            <li class="good">API très pratique</li>
            <li class="good">Gestion clients, factures, relances</li>
            <li class="good">Protection fraude</li>
            <li class="bad">1,4% + 0,25€ par transaction</li>
          </ul>
        </section>

        <section>
          <img src="src/img/stripe_customers.png" alt="">
        </section>

        <section>
          <h3>Abonnement</h3>
          <h3>Génération des factures</h3>
        </section>

      </section>

      <section>

        <h3>Abonnement</h3>

        <section>
          <ol>
            <li>Création d'un produit</li>
            <li>Intégration application</li>
            <li>Webhook</li>
          </ol>
        </section>


        <section>
          <p>Création d'un produit en Ruby</p>
          <pre><code data-trim data-noescape class="ruby">
            product = Stripe::Product.create(
              name: 'Abonnement compte premium',
              type: 'service'
            )

            Stripe::<mark>Plan</mark>.create(
              id:       'premium-monthly'
              interval: :month, amount:  8000,
              currency: :eur,   product: product.id,
            )
          </code></pre>
        </section>

        <section>
          <h3>Front-end</h3>
          <p>Intégration d'un bouton</p>
          <pre><code data-trim data-noescape class="html">
            < script
              src="https://checkout.stripe.com/checkout.js"
              data-key="my_public_stripe_token"
              data-email="<%= current_user.email %>" >
          </code></pre>
        </section>

        <section>
          <h3>Côté back-end</h3>
          <p>Envoi d'une inscription à Stripe</p>
          <pre><code data-trim data-noescape class="ruby">
            # app/controllers/subscriptions_controller.rb
            Stripe::Subscription.create(
              customer: @stripe_customer_id,
              items: [{ plan: 'premium-monthly' }]
            ) rescue Stripe::CardError
          </code></pre>
        </section>

        <section>
          <h3>Webhook</h3>
          <p>Réception du signal que de Stripe</p>
          <pre><code data-trim data-noescape class="ruby">
            # app/controllers/hooks_controller.rb
            def stripe
              if params[:type] == 'invoice.payment_succeeded'
                # magic happen here
              end
            end
          </code></pre>
        </section>
      </section>

      <section>
        <h2>Facturation</h2>
        <section>
          <ol>
            <li><strong style="color: green">ISIGNIF</strong> Ouverture d'une <i>Invoice</i></li>
            <li><strong style="color: green">ISIGNIF</strong> Affectation <i>InvoiceItem</i> à un <i>Customer</i></li>
            <li><strong style="color: blue">STRIPE</strong> Conversion de l' <i>Invoice</i> en PDF</li>
            <li><strong style="color: blue">STRIPE</strong> Collecte / Relance du <i>Customer</i> </li>
          </ol>

        </section>

        <section>
          <p>Création d'un <i>InvoiceItem</i></p>

          <pre><code data-trim data-noescape class="ruby">
            # app/services/invoice_service.rb
            def invoice! signification
              Stripe::InvoiceItem.create #  ...
              @signification.update! invoiced: true
            end
          </code></pre>
        </section>

        <section>
          <img src="src/img/isignif_pay_web.png">
        </section>

      </section>

      <section>
        <h2>Merci</h2>
      </section>


    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/js/reveal.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/lib/js/head.min.js"></script>
  <script>
    Reveal.initialize({
      slideNumber: true,
      history: true,
      // More info https://github.com/hakimel/reveal.js#dependencies
      dependencies: [{
        src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/plugin/highlight/highlight.min.js',
        async: true,
        callback: function() {
          hljs.initHighlightingOnLoad();
        }
      }, ]
    });
  </script>
</body>

</html>
